public class GraphEditor : PCanvas {
    public GraphEditor(int width, int height) {
        this.Size = new Size(width, height);
        int numNodes = 50;
        int numEdges = 50;

        // Initialize, and create a layer for the edges
        // (always underneath the nodes)
        PLayer nodeLayer = this.Layer;
        PLayer edgeLayer = new PLayer();
        Root.AddChild(edgeLayer);
        this.Camera.AddLayer(0, edgeLayer);
        Random rnd = new Random();

        // Create some random nodes
        // Each node's Tag has an ArrayList
        // used to store associated edges
        for (int i=0; i&lt;numNodes; i++) {
            float x = (float)(this.ClientSize.Width * rnd.NextDouble());
            float y = (float)(this.ClientSize.Height * rnd.NextDouble());
            PPath path = PPath.CreateEllipse(x, y, 20, 20);
            path.Tag = new ArrayList();
            nodeLayer.AddChild(path);
        }

        // Create some random edges
        // Each edge's Tag has an ArrayList
        // used to store associated nodes
        for (int i=0; i&lt;numEdges; i++) {
            int n1 = rnd.Next(numNodes);
            int n2 = n1;

            // Make sure we have two distinct nodes.
            while (n2 == n1) {
                n2 = rnd.Next(numNodes);
            }

            PNode node1 = nodeLayer[n1];
            PNode node2 = nodeLayer[n2];
            PPath edge = new PPath();
            ((ArrayList)node1.Tag).Add(edge);
            ((ArrayList)node2.Tag).Add(edge);
            edge.Tag = new ArrayList();
            ((ArrayList)edge.Tag).Add(node1);
            ((ArrayList)edge.Tag).Add(node2);
            edgeLayer.AddChild(edge);
            UpdateEdge(edge);
        }

        // Create event handler to move nodes and update edges
        nodeLayer.AddInputEventListener(new NodeDragHandler());
    }

    public static void UpdateEdge(PPath edge) {
        // Note that the node's "FullBounds" must be used
        // (instead of just the "Bounds") because the nodes
        // have non-identity transforms which must be included
        // when determining their position.

        ArrayList nodes = (ArrayList)edge.Tag;
        PNode node1 = (PNode)nodes[0];
        PNode node2 = (PNode)nodes[1];
        PointF start = PUtil.CenterOfRectangle(node1.FullBounds);
        PointF end = PUtil.CenterOfRectangle(node2.FullBounds);
        edge.Reset();
        edge.AddLine(start.X, start.Y, end.X, end.Y);
    }
}