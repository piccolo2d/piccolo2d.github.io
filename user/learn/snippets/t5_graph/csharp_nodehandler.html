class NodeDragHandler : PDragEventHandler {
    public override bool DoesAcceptEvent(PInputEventArgs e) {
        return e.IsMouseEvent &&
            (e.Button != MouseButtons.None || e.IsMouseEnterOrMouseLeave);
    }

    public override void OnMouseEnter(object sender, PInputEventArgs e) {
        base.OnMouseEnter (sender, e);
        if (e.Button == MouseButtons.None) {
            e.PickedNode.Brush = Brushes.Red;
        }
    }

    public override void OnMouseLeave(object sender, PInputEventArgs e) {
        base.OnMouseLeave (sender, e);
        if (e.Button == MouseButtons.None) {
            e.PickedNode.Brush = Brushes.White;
        }
    }

    protected override void OnStartDrag(object sender, PInputEventArgs e) {
        base.OnStartDrag(sender, e);
        e.Handled = true;
        e.PickedNode.MoveToFront();
    }

    protected override void OnDrag(object sender, PInputEventArgs e) {
        base.OnDrag (sender, e);

        ArrayList edges = (ArrayList)e.PickedNode.Tag;
        foreach (PPath edge in edges) {
            GraphEditor.UpdateEdge(edge);
        }
    }
}
