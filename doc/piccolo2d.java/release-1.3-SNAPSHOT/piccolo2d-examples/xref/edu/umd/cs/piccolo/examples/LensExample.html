<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
<title>LensExample xref</title>
<link type="text/css" rel="stylesheet" href="../../../../../stylesheet.css" />
</head>
<body>
<div id="overview"><a href="../../../../../../apidocs/edu/umd/cs/piccolo/examples/LensExample.html">View Javadoc</a></div><pre>

<a name="1" href="#1">1</a>   <strong class="jxr_keyword">package</strong> edu.umd.cs.piccolo.examples;
<a name="2" href="#2">2</a>   
<a name="3" href="#3">3</a>   <strong class="jxr_keyword">import</strong> java.awt.Color;
<a name="4" href="#4">4</a>   <strong class="jxr_keyword">import</strong> java.awt.Graphics2D;
<a name="5" href="#5">5</a>   <strong class="jxr_keyword">import</strong> java.awt.geom.Point2D;
<a name="6" href="#6">6</a>   
<a name="7" href="#7">7</a>   <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.PCamera;
<a name="8" href="#8">8</a>   <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.PCanvas;
<a name="9" href="#9">9</a>   <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.PLayer;
<a name="10" href="#10">10</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.PNode;
<a name="11" href="#11">11</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.PRoot;
<a name="12" href="#12">12</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.event.PDragSequenceEventHandler;
<a name="13" href="#13">13</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.event.PInputEvent;
<a name="14" href="#14">14</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.nodes.PPath;
<a name="15" href="#15">15</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.nodes.PText;
<a name="16" href="#16">16</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolo.util.PPaintContext;
<a name="17" href="#17">17</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolox.PFrame;
<a name="18" href="#18">18</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolox.handles.PBoundsHandle;
<a name="19" href="#19">19</a>  <strong class="jxr_keyword">import</strong> edu.umd.cs.piccolox.nodes.PLens;
<a name="20" href="#20">20</a>  
<a name="21" href="#21">21</a>  <em class="jxr_javadoccomment">/**</em>
<a name="22" href="#22">22</a>  <em class="jxr_javadoccomment"> * This example shows one way to create and use lens's in Piccolo.</em>
<a name="23" href="#23">23</a>  <em class="jxr_javadoccomment"> */</em>
<a name="24" href="#24">24</a>  <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">class</strong> <a href="../../../../../edu/umd/cs/piccolo/examples/LensExample.html">LensExample</a> <strong class="jxr_keyword">extends</strong> PFrame {
<a name="25" href="#25">25</a>  
<a name="26" href="#26">26</a>      <strong class="jxr_keyword">public</strong> <a href="../../../../../edu/umd/cs/piccolo/examples/LensExample.html">LensExample</a>() {
<a name="27" href="#27">27</a>          <strong class="jxr_keyword">this</strong>(<strong class="jxr_keyword">null</strong>);
<a name="28" href="#28">28</a>      }
<a name="29" href="#29">29</a>  
<a name="30" href="#30">30</a>      <strong class="jxr_keyword">public</strong> <a href="../../../../../edu/umd/cs/piccolo/examples/LensExample.html">LensExample</a>(PCanvas aCanvas) {
<a name="31" href="#31">31</a>          <strong class="jxr_keyword">super</strong>(<span class="jxr_string">"LensExample"</span>, false, aCanvas);
<a name="32" href="#32">32</a>      }
<a name="33" href="#33">33</a>  
<a name="34" href="#34">34</a>      <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> initialize() {
<a name="35" href="#35">35</a>          PRoot root = getCanvas().getRoot();
<a name="36" href="#36">36</a>          PCamera camera = getCanvas().getCamera();
<a name="37" href="#37">37</a>          <em class="jxr_comment">// viewed by the PCanvas camera, the lens is added to this layer.</em>
<a name="38" href="#38">38</a>          PLayer mainLayer = getCanvas().getLayer();
<a name="39" href="#39">39</a>          <em class="jxr_comment">// viewed by both the lens camera and the PCanvas camera</em>
<a name="40" href="#40">40</a>          PLayer sharedLayer = <strong class="jxr_keyword">new</strong> PLayer();
<a name="41" href="#41">41</a>          <em class="jxr_comment">// viewed by only the lens camera</em>
<a name="42" href="#42">42</a>          <strong class="jxr_keyword">final</strong> PLayer lensOnlyLayer = <strong class="jxr_keyword">new</strong> PLayer();
<a name="43" href="#43">43</a>  
<a name="44" href="#44">44</a>          root.addChild(lensOnlyLayer);
<a name="45" href="#45">45</a>          root.addChild(sharedLayer);
<a name="46" href="#46">46</a>          camera.addLayer(0, sharedLayer);
<a name="47" href="#47">47</a>  
<a name="48" href="#48">48</a>          <strong class="jxr_keyword">final</strong> PLens lens = <strong class="jxr_keyword">new</strong> PLens();
<a name="49" href="#49">49</a>          lens.setBounds(10, 10, 100, 130);
<a name="50" href="#50">50</a>          lens.addLayer(0, lensOnlyLayer);
<a name="51" href="#51">51</a>          lens.addLayer(1, sharedLayer);
<a name="52" href="#52">52</a>          mainLayer.addChild(lens);
<a name="53" href="#53">53</a>          PBoundsHandle.addBoundsHandlesTo(lens);
<a name="54" href="#54">54</a>  
<a name="55" href="#55">55</a>          <em class="jxr_comment">// Create an event handler that draws squiggles on the first layer of</em>
<a name="56" href="#56">56</a>          <em class="jxr_comment">// the bottom most camera.</em>
<a name="57" href="#57">57</a>          PDragSequenceEventHandler squiggleEventHandler = <strong class="jxr_keyword">new</strong> PDragSequenceEventHandler() {
<a name="58" href="#58">58</a>              <strong class="jxr_keyword">protected</strong> PPath squiggle;
<a name="59" href="#59">59</a>  
<a name="60" href="#60">60</a>              <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> startDrag(PInputEvent e) {
<a name="61" href="#61">61</a>                  <strong class="jxr_keyword">super</strong>.startDrag(e);
<a name="62" href="#62">62</a>                  Point2D p = e.getPosition();
<a name="63" href="#63">63</a>                  squiggle = <strong class="jxr_keyword">new</strong> PPath();
<a name="64" href="#64">64</a>                  squiggle.moveTo((<strong class="jxr_keyword">float</strong>) p.getX(), (<strong class="jxr_keyword">float</strong>) p.getY());
<a name="65" href="#65">65</a>  
<a name="66" href="#66">66</a>                  <em class="jxr_comment">// add squiggles to the first layer of the bottom camera. In the</em>
<a name="67" href="#67">67</a>                  <em class="jxr_comment">// case of the lens these squiggles will be added to the layer</em>
<a name="68" href="#68">68</a>                  <em class="jxr_comment">// that is only visible by the lens,</em>
<a name="69" href="#69">69</a>                  <em class="jxr_comment">// In the case of the canvas camera the squiggles will be added</em>
<a name="70" href="#70">70</a>                  <em class="jxr_comment">// to the shared layer viewed by both the canvas camera and the</em>
<a name="71" href="#71">71</a>                  <em class="jxr_comment">// lens.</em>
<a name="72" href="#72">72</a>                  e.getCamera().getLayer(0).addChild(squiggle);
<a name="73" href="#73">73</a>              }
<a name="74" href="#74">74</a>  
<a name="75" href="#75">75</a>              <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> drag(PInputEvent e) {
<a name="76" href="#76">76</a>                  <strong class="jxr_keyword">super</strong>.drag(e);
<a name="77" href="#77">77</a>                  updateSquiggle(e);
<a name="78" href="#78">78</a>              }
<a name="79" href="#79">79</a>  
<a name="80" href="#80">80</a>              <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> endDrag(PInputEvent e) {
<a name="81" href="#81">81</a>                  <strong class="jxr_keyword">super</strong>.endDrag(e);
<a name="82" href="#82">82</a>                  updateSquiggle(e);
<a name="83" href="#83">83</a>                  squiggle = <strong class="jxr_keyword">null</strong>;
<a name="84" href="#84">84</a>              }
<a name="85" href="#85">85</a>  
<a name="86" href="#86">86</a>              <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> updateSquiggle(PInputEvent aEvent) {
<a name="87" href="#87">87</a>                  Point2D p = aEvent.getPosition();
<a name="88" href="#88">88</a>                  squiggle.lineTo((<strong class="jxr_keyword">float</strong>) p.getX(), (<strong class="jxr_keyword">float</strong>) p.getY());
<a name="89" href="#89">89</a>              }
<a name="90" href="#90">90</a>          };
<a name="91" href="#91">91</a>  
<a name="92" href="#92">92</a>          <em class="jxr_comment">// add the squiggle event handler to both the lens and the</em>
<a name="93" href="#93">93</a>          <em class="jxr_comment">// canvas camera.</em>
<a name="94" href="#94">94</a>          lens.getCamera().addInputEventListener(squiggleEventHandler);
<a name="95" href="#95">95</a>          camera.addInputEventListener(squiggleEventHandler);
<a name="96" href="#96">96</a>  
<a name="97" href="#97">97</a>          <em class="jxr_comment">// make sure that the event handler consumes events so that it doesn't</em>
<a name="98" href="#98">98</a>          <em class="jxr_comment">// conflic with other event handlers or with itself (since its added to</em>
<a name="99" href="#99">99</a>          <em class="jxr_comment">// two event sources).</em>
<a name="100" href="#100">100</a>         squiggleEventHandler.getEventFilter().setMarksAcceptedEventsAsHandled(<strong class="jxr_keyword">true</strong>);
<a name="101" href="#101">101</a> 
<a name="102" href="#102">102</a>         <em class="jxr_comment">// remove default event handlers, not really nessessary since the</em>
<a name="103" href="#103">103</a>         <em class="jxr_comment">// squiggleEventHandler consumes everything anyway, but still good to</em>
<a name="104" href="#104">104</a>         <em class="jxr_comment">// do.</em>
<a name="105" href="#105">105</a>         getCanvas().removeInputEventListener(getCanvas().getPanEventHandler());
<a name="106" href="#106">106</a>         getCanvas().removeInputEventListener(getCanvas().getZoomEventHandler());
<a name="107" href="#107">107</a> 
<a name="108" href="#108">108</a>         <em class="jxr_comment">// create a node that is viewed both by the main camera and by the</em>
<a name="109" href="#109">109</a>         <em class="jxr_comment">// lens. Note that in its paint method it checks to see which camera</em>
<a name="110" href="#110">110</a>         <em class="jxr_comment">// is painting it, and if its the lens uses a different color.</em>
<a name="111" href="#111">111</a>         PNode sharedNode = <strong class="jxr_keyword">new</strong> PNode() {
<a name="112" href="#112">112</a>             <strong class="jxr_keyword">protected</strong> <strong class="jxr_keyword">void</strong> paint(PPaintContext paintContext) {
<a name="113" href="#113">113</a>                 <strong class="jxr_keyword">if</strong> (paintContext.getCamera() == lens.getCamera()) {
<a name="114" href="#114">114</a>                     Graphics2D g2 = paintContext.getGraphics();
<a name="115" href="#115">115</a>                     g2.setPaint(Color.RED);
<a name="116" href="#116">116</a>                     g2.fill(getBoundsReference());
<a name="117" href="#117">117</a>                 }
<a name="118" href="#118">118</a>                 <strong class="jxr_keyword">else</strong> {
<a name="119" href="#119">119</a>                     <strong class="jxr_keyword">super</strong>.paint(paintContext);
<a name="120" href="#120">120</a>                 }
<a name="121" href="#121">121</a>             }
<a name="122" href="#122">122</a>         };
<a name="123" href="#123">123</a>         sharedNode.setPaint(Color.GREEN);
<a name="124" href="#124">124</a>         sharedNode.setBounds(0, 0, 100, 200);
<a name="125" href="#125">125</a>         sharedNode.translate(200, 200);
<a name="126" href="#126">126</a>         sharedLayer.addChild(sharedNode);
<a name="127" href="#127">127</a> 
<a name="128" href="#128">128</a>         PText label = <strong class="jxr_keyword">new</strong> PText(
<a name="129" href="#129">129</a>                 <span class="jxr_string">"Move the lens \n (by dragging title bar) over the green rectangle, and it will appear red. press and drag the mouse on the canvas and it will draw squiggles. press and drag the mouse over the lens and drag squiggles that are only visible through the lens."</span>);
<a name="130" href="#130">130</a>         label.setConstrainWidthToTextWidth(false);
<a name="131" href="#131">131</a>         label.setConstrainHeightToTextHeight(false);
<a name="132" href="#132">132</a>         label.setBounds(200, 100, 200, 200);
<a name="133" href="#133">133</a> 
<a name="134" href="#134">134</a>         sharedLayer.addChild(label);
<a name="135" href="#135">135</a>     }
<a name="136" href="#136">136</a> 
<a name="137" href="#137">137</a>     <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">static</strong> <strong class="jxr_keyword">void</strong> main(String[] args) {
<a name="138" href="#138">138</a>         <strong class="jxr_keyword">new</strong> <a href="../../../../../edu/umd/cs/piccolo/examples/LensExample.html">LensExample</a>();
<a name="139" href="#139">139</a>     }
<a name="140" href="#140">140</a> }
</pre>
<hr/><div id="footer">This page was automatically generated by <a href="http://maven.apache.org/">Maven</a></div></body>
</html>

